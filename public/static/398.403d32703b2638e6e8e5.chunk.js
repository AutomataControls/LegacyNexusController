"use strict";(self.webpackChunkautomata_neural_nexus_portal=self.webpackChunkautomata_neural_nexus_portal||[]).push([[398],{1707:(n,e,s)=>{s.d(e,{A:()=>i});var a=s(1601),o=s.n(a),r=s(6314),t=s.n(r)()(o());t.push([n.id,'/* Vibration Monitor - Light/Teal Theme matching main app */\n.vibration-monitor {\n  padding: 20px;\n  height: calc(100vh - 80px);\n  overflow-y: auto;\n  background: #f9fafb;\n}\n\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 30px;\n  padding: 20px;\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  border: 1px solid #e5e7eb;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 15px;\n}\n\n.header-left h1 {\n  font-size: 24px;\n  font-weight: 600;\n  color: #1f2937;\n  margin: 0;\n}\n\n.header-right {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.btn-primary, .btn-secondary {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 10px 20px;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  border: none;\n  cursor: pointer;\n  transition: all 0.3s ease;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);\n  color: white;\n}\n\n.btn-primary:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 10px 20px rgba(20, 184, 166, 0.3);\n}\n\n.btn-secondary {\n  background: white;\n  color: #374151;\n  border: 1px solid #d1d5db;\n}\n\n.btn-secondary:hover {\n  background: #f3f4f6;\n  border-color: #9ca3af;\n}\n\n.save-status {\n  padding: 8px 16px;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  animation: fadeIn 0.3s ease;\n}\n\n.save-status.success {\n  background: #d1fae5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n\n.save-status.error {\n  background: #fee2e2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n.sensors-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(500px, 1fr));\n  gap: 20px;\n  margin-bottom: 20px;\n}\n\n.sensor-card {\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 12px;\n  padding: 20px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  transition: all 0.3s ease;\n}\n\n.sensor-card:hover {\n  border-color: #14b8a6;\n  box-shadow: 0 4px 20px rgba(20, 184, 166, 0.15);\n}\n\n.sensor-card.disabled {\n  opacity: 0.6;\n  background: #f9fafb;\n}\n\n.sensor-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 15px;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.sensor-title {\n  display: flex;\n  align-items: center;\n  gap: 15px;\n}\n\n.name-display {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n.name-display h3 {\n  font-size: 18px;\n  font-weight: 600;\n  color: #1f2937;\n  margin: 0;\n}\n\n.name-edit {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.name-edit input {\n  padding: 6px 10px;\n  background: white;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  color: #1f2937;\n  font-size: 16px;\n  width: 200px;\n}\n\n.sensor-port {\n  padding: 4px 8px;\n  background: #f3f4f6;\n  border-radius: 4px;\n  color: #6b7280;\n  font-size: 12px;\n  font-family: monospace;\n}\n\n.sensor-controls {\n  display: flex;\n  gap: 8px;\n}\n\n.btn-icon {\n  padding: 8px;\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 6px;\n  color: #6b7280;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.btn-icon:hover {\n  background: #f3f4f6;\n  color: #374151;\n  border-color: #9ca3af;\n}\n\n.btn-icon.active {\n  background: #d1fae5;\n  color: #14b8a6;\n  border-color: #14b8a6;\n}\n\n.btn-icon.danger:hover {\n  background: #fee2e2;\n  color: #ef4444;\n  border-color: #ef4444;\n}\n\n/* Threshold Control Section */\n.threshold-control {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px;\n  background: #f9fafb;\n  border-radius: 8px;\n  margin-bottom: 10px;\n}\n\n.threshold-control label {\n  font-size: 14px;\n  color: #374151;\n  font-weight: 500;\n}\n\n.threshold-input {\n  width: 80px;\n  padding: 6px 10px;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  font-size: 14px;\n  text-align: center;\n}\n\n.threshold-save {\n  padding: 6px 12px;\n  background: #14b8a6;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.threshold-save:hover {\n  background: #0d9488;\n  transform: translateY(-1px);\n}\n\n/* Baseline Control Section */\n.baseline-control {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 10px;\n  background: #f3f9ff;\n  border: 1px solid #bfdbfe;\n  border-radius: 8px;\n  margin-bottom: 15px;\n}\n\n.baseline-btn {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 8px;\n  background: #0ea5e9;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.baseline-btn:hover:not(:disabled) {\n  background: #0284c7;\n  transform: translateY(-1px);\n}\n\n.baseline-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.baseline-info {\n  font-size: 14px;\n  color: #1e40af;\n  font-weight: 500;\n  padding: 4px 8px;\n  background: #dbeafe;\n  border-radius: 4px;\n}\n\n.baseline-clear-btn {\n  padding: 6px 10px;\n  background: white;\n  color: #ef4444;\n  border: 1px solid #fecaca;\n  border-radius: 6px;\n  font-size: 13px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.baseline-clear-btn:hover {\n  background: #fee2e2;\n  border-color: #ef4444;\n}\n\n.relative-toggle {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 14px;\n  color: #374151;\n  cursor: pointer;\n  margin-left: auto;\n}\n\n.relative-toggle input[type="checkbox"] {\n  cursor: pointer;\n}\n\n.baseline-reference {\n  font-size: 12px;\n  color: #6b7280;\n  margin-left: 8px;\n  font-style: italic;\n}\n\n.sensor-readings {\n  margin-bottom: 20px;\n}\n\n.reading-grid {\n  display: grid;\n  grid-template-columns: repeat(4, 1fr);\n  gap: 15px;\n  margin-bottom: 15px;\n}\n\n.reading-item {\n  display: flex;\n  flex-direction: column;\n  gap: 5px;\n}\n\n.reading-item .label {\n  font-size: 12px;\n  color: #6b7280;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.reading-item .value {\n  font-size: 16px;\n  font-weight: 600;\n  color: #1f2937;\n  display: flex;\n  align-items: center;\n  gap: 5px;\n}\n\n.reading-item .value.large {\n  font-size: 20px;\n}\n\n.iso-zone {\n  padding: 4px 8px;\n  border-radius: 4px;\n  font-weight: 600;\n  font-size: 14px;\n  display: inline-block;\n}\n\n.iso-zone.zone-A {\n  background: #d1fae5;\n  color: #065f46;\n  border: 1px solid #a7f3d0;\n}\n\n.iso-zone.zone-B {\n  background: #fed7aa;\n  color: #92400e;\n  border: 1px solid #fdba74;\n}\n\n.iso-zone.zone-C {\n  background: #fee2e2;\n  color: #991b1b;\n  border: 1px solid #fecaca;\n}\n\n.iso-zone.zone-D {\n  background: #fecaca;\n  color: #7f1d1d;\n  border: 1px solid #fca5a5;\n}\n\n.status {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 500;\n}\n\n.axis-readings {\n  display: flex;\n  gap: 15px;\n  padding: 10px;\n  background: #f9fafb;\n  border-radius: 8px;\n  border: 1px solid #e5e7eb;\n}\n\n.axis {\n  flex: 1;\n  text-align: center;\n}\n\n.axis span {\n  font-size: 13px;\n  color: #6b7280;\n  font-family: monospace;\n}\n\n.sensor-graph {\n  margin-top: 20px;\n  padding: 15px;\n  background: #f9fafb;\n  border-radius: 8px;\n  border: 1px solid #e5e7eb;\n}\n\n/* Modal Styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: white;\n  border: 1px solid #e5e7eb;\n  border-radius: 12px;\n  width: 90%;\n  max-width: 500px;\n  max-height: 80vh;\n  overflow-y: auto;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 20px;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.modal-header h2 {\n  font-size: 20px;\n  font-weight: 600;\n  color: #1f2937;\n  margin: 0;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.form-group {\n  margin-bottom: 20px;\n}\n\n.form-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  color: #374151;\n}\n\n.form-group input,\n.form-group select {\n  width: 100%;\n  padding: 10px;\n  background: white;\n  border: 1px solid #d1d5db;\n  border-radius: 6px;\n  color: #1f2937;\n  font-size: 14px;\n}\n\n.form-group input:focus,\n.form-group select:focus {\n  outline: none;\n  border-color: #14b8a6;\n  box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);\n}\n\n.form-group small {\n  display: block;\n  margin-top: 5px;\n  font-size: 12px;\n  color: #6b7280;\n}\n\n.form-actions {\n  display: flex;\n  gap: 10px;\n  justify-content: flex-end;\n  margin-top: 30px;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@media (max-width: 768px) {\n  .sensors-grid {\n    grid-template-columns: 1fr;\n  }\n\n  .reading-grid {\n    grid-template-columns: repeat(2, 1fr);\n  }\n\n  .axis-readings {\n    flex-direction: column;\n    gap: 8px;\n  }\n}',""]);const i=t},5398:(n,e,s)=>{s.r(e),s.d(e,{default:()=>P});var a=s(4848),o=s(6540),r=s(6844),t=s(418),i=s(5977),l=s(697),d=s(5773),c=s(8697),p=s(4934),x=s(3160),m=s(3540),b=s(3136),h=s(964),g=s(2708),u=s(7792),f=s(6713),y=s(8852),v=s(4653),j=s(2746),w=s(9107),k=s(7984),_=s(5869),N=s(1096),A=s(4296),S=s(7158),z=s(8825),C=s(5072),T=s.n(C),E=s(7825),M=s.n(E),$=s(7659),B=s.n($),F=s(5056),D=s.n(F),I=s(540),O=s.n(I),q=s(1113),U=s.n(q),W=s(1707),Z={};Z.styleTagTransform=U(),Z.setAttributes=D(),Z.insert=B().bind(null,"head"),Z.domAPI=M(),Z.insertStyleElement=O(),T()(W.A,Z),W.A&&W.A.locals&&W.A.locals;const P=()=>{const[n,e]=(0,o.useState)([]),[s,C]=(0,o.useState)(new Map),[T,E]=(0,o.useState)(new Map),[M,$]=(0,o.useState)([]),[B,F]=(0,o.useState)(new Map),[D,I]=(0,o.useState)(null),[O,q]=(0,o.useState)(""),[U,W]=(0,o.useState)(""),[Z,P]=(0,o.useState)(null),[Y,R]=(0,o.useState)(new Map),[V,K]=(0,o.useState)(new Map),L=2.8,G="#10b981",J=7.1,H="#f59e0b",X=11,Q="#ef4444",nn="#dc2626",en=(0,o.useCallback)(async()=>{try{const n=await fetch("/api/vibration/configs");if(!n.ok)return void console.error("Failed to fetch sensors:",n.status);const s=await n.json(),a=Array.isArray(s)?s:[];e(a);const o=new Map;a.forEach(n=>{o.set(n.sensor_id,!0)}),F(o)}catch(n){console.error("Error fetching sensors:",n)}},[]),sn=(0,o.useCallback)(async()=>{try{const n=await fetch("/api/vibration/ports");if(!n.ok)return;const e=await n.json();$(Array.isArray(e)?e:[])}catch(n){console.error("Error fetching ports:",n)}},[]),an=(0,o.useCallback)(async()=>{try{console.log("Fetching vibration readings...");const n=await fetch("/api/vibration/readings");if(!n.ok)return void console.warn("Vibration readings not available:",n.status);const e=await n.json();console.log("Received readings:",e);const s=new Map;"object"!=typeof e||Array.isArray(e)?Array.isArray(e)&&e.forEach(n=>{s.set(n.sensor_id,n)}):Object.entries(e).forEach(([n,e])=>{s.set(n,e)}),C(s)}catch(n){console.warn("Vibration readings unavailable:",n)}},[]),on=(0,o.useCallback)(async n=>{try{const e=await fetch(`/api/vibration/history/${n}?hours=8`),s=(await e.json()).map(n=>({time:new Date(n.timestamp).toLocaleTimeString(),velocity:n.velocity_mms,temperature:n.temperature_f,x:n.velocity_x,y:n.velocity_y,z:n.velocity_z}));E(e=>{const a=new Map(e);return a.set(n,s),a})}catch(n){console.error("Error fetching historical data:",n)}},[]),rn=async n=>{try{const e=sessionStorage.getItem("authToken");(await fetch("/api/vibration/configs",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(n)})).ok&&(await en(),W("Configuration saved"),setTimeout(()=>W(""),3e3))}catch(n){console.error("Error updating sensor:",n),W("Error saving configuration")}},tn=n=>{switch(n){case"Good":return(0,a.jsx)(r.A,{className:"w-5 h-5 text-green-500"});case"Acceptable":return(0,a.jsx)(r.A,{className:"w-5 h-5 text-yellow-500"});case"Warning":return(0,a.jsx)(t.A,{className:"w-5 h-5 text-orange-500"});case"Unsatisfactory":case"Unacceptable":return(0,a.jsx)(t.A,{className:"w-5 h-5 text-red-500"});default:return(0,a.jsx)(r.A,{className:"w-5 h-5 text-gray-500"})}};return(0,o.useEffect)(()=>{en(),sn(),an()},[]),(0,o.useEffect)(()=>{},[n,B]),(0,a.jsxs)("div",{className:"vibration-monitor",children:[(0,a.jsxs)("div",{className:"page-header",children:[(0,a.jsxs)("div",{className:"header-left",children:[(0,a.jsx)(r.A,{className:"w-8 h-8 text-cyan-400"}),(0,a.jsx)("h1",{children:"Vibration Monitoring System"})]}),(0,a.jsxs)("div",{className:"header-right",children:[(0,a.jsxs)("button",{onClick:an,className:"btn-secondary",children:[(0,a.jsx)(i.A,{className:"w-4 h-4"}),"Refresh Readings"]}),(0,a.jsxs)("button",{onClick:sn,className:"btn-secondary",children:[(0,a.jsx)(i.A,{className:"w-4 h-4"}),"Scan Ports"]}),(0,a.jsxs)("button",{onClick:async()=>{const e=`sensor_${Date.now()}`,s={sensor_id:e,equipment_name:`Sensor ${n.length+1}`,port:M[0]||"/dev/ttyUSB0",modbus_id:80,baud_rate:9600,alert_threshold_mms:7.1,enabled:!1};try{const a=sessionStorage.getItem("authToken");(await fetch("/api/vibration/configs",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`},body:JSON.stringify(s)})).ok&&(await en(),W("Sensor added successfully"),setTimeout(()=>W(""),3e3),I(e),q(`Sensor ${n.length+1}`))}catch(n){console.error("Error adding sensor:",n),W("Error adding sensor")}},className:"btn-primary",children:[(0,a.jsx)(l.A,{className:"w-4 h-4"}),"Add Sensor"]}),U&&(0,a.jsx)("span",{className:"save-status "+(U.includes("Error")?"error":"success"),children:U})]})]}),(0,a.jsx)("div",{className:"sensors-grid",children:n.map(o=>{const i=s.get(o.sensor_id),l=T.get(o.sensor_id)||[],y=B.get(o.sensor_id)||!1;return(0,a.jsxs)("div",{className:"sensor-card "+(o.enabled?"":"disabled"),children:[(0,a.jsxs)("div",{className:"sensor-header",children:[(0,a.jsxs)("div",{className:"sensor-title",children:[D===o.sensor_id?(0,a.jsxs)("div",{className:"name-edit",children:[(0,a.jsx)("input",{type:"text",value:O||o.equipment_name,onChange:n=>q(n.target.value),autoFocus:!0}),(0,a.jsx)("button",{onClick:()=>(async(n,e)=>{const s={...n,equipment_name:e};await rn(s),I(null),q("")})(o,O||o.equipment_name),className:"btn-icon",children:(0,a.jsx)(d.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{I(null),q("")},className:"btn-icon",children:(0,a.jsx)(c.A,{className:"w-4 h-4"})})]}):(0,a.jsxs)("div",{className:"name-display",children:[(0,a.jsx)("h3",{children:o.equipment_name}),(0,a.jsx)("button",{onClick:()=>{I(o.sensor_id),q(o.equipment_name)},className:"btn-icon",children:(0,a.jsx)(p.A,{className:"w-4 h-4"})})]}),(0,a.jsx)("span",{className:"sensor-port",children:o.port})]}),(0,a.jsxs)("div",{className:"sensor-controls",children:[(0,a.jsx)("button",{onClick:()=>{return n=o.sensor_id,void F(e=>{const s=new Map(e),a=!e.get(n);return s.set(n,a),a&&on(n),s});var n},className:"btn-icon",title:y?"Hide Graph":"Show Graph",children:y?(0,a.jsx)(x.A,{className:"w-4 h-4"}):(0,a.jsx)(m.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>(async n=>{const e={...n,enabled:!n.enabled};await rn(e)})(o),className:"btn-icon "+(o.enabled?"active":""),title:o.enabled?"Disable":"Enable",children:(0,a.jsx)(b.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>P(o.sensor_id),className:"btn-icon",title:"Settings",children:(0,a.jsx)(h.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>(async n=>{if(confirm("Are you sure you want to delete this sensor?"))try{const s=sessionStorage.getItem("authToken");(await fetch(`/api/vibration/configs/${n}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok&&(e(e=>e.filter(e=>e.sensor_id!==n)),C(e=>{const s=new Map(e);return s.delete(n),s}),E(e=>{const s=new Map(e);return s.delete(n),s}),F(e=>{const s=new Map(e);return s.delete(n),s}),W("Sensor deleted"),setTimeout(()=>W(""),3e3))}catch(n){console.error("Error deleting sensor:",n),W("Error deleting sensor")}})(o.sensor_id),className:"btn-icon danger",title:"Delete",children:(0,a.jsx)(g.A,{className:"w-4 h-4"})})]})]}),(0,a.jsxs)("div",{className:"threshold-control",children:[(0,a.jsx)("label",{children:"Alert Threshold:"}),(0,a.jsx)("input",{type:"number",step:"0.1",className:"threshold-input",value:V.get(o.sensor_id)??o.alert_threshold_mms,onChange:s=>{const a=parseFloat(s.target.value)||7.1;K(n=>{const e=new Map(n);return e.set(o.sensor_id,a),e});const r=n.map(n=>n.sensor_id===o.sensor_id?{...n,alert_threshold_mms:a}:n);e(r)},onBlur:()=>{V.has(o.sensor_id)&&(rn(o),K(n=>{const e=new Map(n);return e.delete(o.sensor_id),e}))}}),(0,a.jsx)("span",{style:{color:"#6b7280",fontSize:"14px"},children:"mm/s"})]}),(0,a.jsxs)("div",{className:"baseline-control",children:[(0,a.jsxs)("button",{className:"baseline-btn",onClick:()=>(async n=>{const a=s.get(n.sensor_id);if(!a)return W("No reading available to capture"),void setTimeout(()=>W(""),3e3);const o={...n,baseline_velocity:a.velocity_mms||0,baseline_timestamp:(new Date).toISOString()};try{const s=sessionStorage.getItem("authToken");(await fetch(`/api/vibration/baseline/${n.sensor_id}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({baseline_velocity:a.velocity_mms||0,baseline_timestamp:(new Date).toISOString()})})).ok&&(e(e=>e.map(e=>e.sensor_id===n.sensor_id?o:e)),W(`Baseline captured: ${(a.velocity_mms||0).toFixed(2)} mm/s`),setTimeout(()=>W(""),3e3))}catch(n){console.error("Error capturing baseline:",n),W("Error capturing baseline"),setTimeout(()=>W(""),3e3)}})(o),disabled:!i,title:"Capture current reading as baseline",children:[(0,a.jsx)(u.A,{className:"w-3 h-3"}),"Set Baseline"]}),void 0!==o.baseline_velocity&&null!==o.baseline_velocity&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("span",{className:"baseline-info",children:["Baseline: ",o.baseline_velocity.toFixed(2)," mm/s"]}),(0,a.jsx)("button",{className:"baseline-clear-btn",onClick:()=>(async n=>{const s={...n,baseline_velocity:void 0,baseline_timestamp:void 0};try{const a=sessionStorage.getItem("authToken");(await fetch(`/api/vibration/baseline/${n.sensor_id}`,{method:"DELETE",headers:{Authorization:`Bearer ${a}`}})).ok&&(e(e=>e.map(e=>e.sensor_id===n.sensor_id?s:e)),W("Baseline cleared"),setTimeout(()=>W(""),3e3))}catch(n){console.error("Error clearing baseline:",n),W("Error clearing baseline"),setTimeout(()=>W(""),3e3)}})(o),title:"Clear baseline",children:"Clear"}),(0,a.jsxs)("label",{className:"relative-toggle",children:[(0,a.jsx)("input",{type:"checkbox",checked:Y.get(o.sensor_id)||!1,onChange:()=>{return n=o.sensor_id,void R(e=>{const s=new Map(e);return s.set(n,!e.get(n)),s});var n}}),(0,a.jsx)("span",{children:"Show Relative"})]})]})]}),i?i.error?(0,a.jsxs)("div",{className:"sensor-error",children:[(0,a.jsx)(t.A,{className:"w-5 h-5 text-red-500"}),(0,a.jsx)("span",{className:"error-message",children:i.errorMessage||"Sensor connection failed"}),(0,a.jsx)("small",{children:"Check USB connection and port configuration"})]}):(0,a.jsxs)("div",{className:"sensor-readings",children:[(0,a.jsxs)("div",{className:"reading-grid",children:[(0,a.jsxs)("div",{className:"reading-item",children:[(0,a.jsx)("span",{className:"label",children:"Velocity"}),(0,a.jsx)("span",{className:"value large",style:{color:(M=i.velocity_mms||0,M<=L?G:M<=J?H:M<=X?Q:nn)},children:Y.get(o.sensor_id)&&void 0!==o.baseline_velocity?`${(i.velocity_mms||0)-o.baseline_velocity>=0?"+":""}${((i.velocity_mms||0)-o.baseline_velocity).toFixed(2)} mm/s`:`${(i.velocity_mms||0).toFixed(2)} mm/s`}),Y.get(o.sensor_id)&&void 0!==o.baseline_velocity&&(0,a.jsxs)("span",{className:"baseline-reference",children:["(Actual: ",(i.velocity_mms||0).toFixed(2),")"]})]}),(0,a.jsxs)("div",{className:"reading-item",children:[(0,a.jsx)("span",{className:"label",children:"Temperature"}),(0,a.jsxs)("span",{className:"value",children:[(0,a.jsx)(f.A,{className:"w-4 h-4 inline"}),(i.temperature_f||0).toFixed(1),"°F"]})]}),(0,a.jsxs)("div",{className:"reading-item",children:[(0,a.jsx)("span",{className:"label",children:"ISO Zone"}),(0,a.jsx)("span",{className:`iso-zone zone-${i.iso_zone||"unknown"}`,children:i.iso_zone||"Unknown"})]}),(0,a.jsxs)("div",{className:"reading-item",children:[(0,a.jsx)("span",{className:"label",children:"Status"}),(0,a.jsxs)("div",{className:"status",children:[tn(i.alert_level||"Unknown"),(0,a.jsx)("span",{children:i.alert_level||"Unknown"})]})]})]}),(0,a.jsxs)("div",{className:"axis-readings",children:[(0,a.jsx)("div",{className:"axis",children:(0,a.jsxs)("span",{children:["X: ",i.velocity_x?.toFixed(2)||"0.00"]})}),(0,a.jsx)("div",{className:"axis",children:(0,a.jsxs)("span",{children:["Y: ",i.velocity_y?.toFixed(2)||"0.00"]})}),(0,a.jsx)("div",{className:"axis",children:(0,a.jsxs)("span",{children:["Z: ",i.velocity_z?.toFixed(2)||"0.00"]})})]})]}):(0,a.jsxs)("div",{className:"sensor-no-data",children:[(0,a.jsx)(r.A,{className:"w-5 h-5 text-gray-400"}),(0,a.jsx)("span",{children:o.enabled?"Waiting for data...":"Sensor disabled"})]}),y&&o.enabled&&l.length>0&&(0,a.jsx)("div",{className:"sensor-graph",children:(0,a.jsx)(v.u,{width:"100%",height:200,children:(0,a.jsxs)(j.b,{data:l,children:[(0,a.jsx)(w.d,{strokeDasharray:"3 3",stroke:"#374151"}),(0,a.jsx)(k.W,{dataKey:"time",stroke:"#9ca3af",tick:{fontSize:10}}),(0,a.jsx)(_.h,{stroke:"#9ca3af",tick:{fontSize:10},domain:[0,15]}),(0,a.jsx)(N.m,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb"}}),(0,a.jsx)(A.s,{}),(0,a.jsx)(S.e,{y:2.8,stroke:"#10b981",strokeDasharray:"5 5",label:"Zone A"}),(0,a.jsx)(S.e,{y:7.1,stroke:"#f59e0b",strokeDasharray:"5 5",label:"Zone B"}),(0,a.jsx)(S.e,{y:11,stroke:"#ef4444",strokeDasharray:"5 5",label:"Zone C"}),(0,a.jsx)(S.e,{y:o.alert_threshold_mms,stroke:"#dc2626",strokeWidth:2,label:"Alert"}),(0,a.jsx)(z.N,{type:"monotone",dataKey:"velocity",stroke:"#06b6d4",strokeWidth:2,dot:!1,name:"RMS Velocity",isAnimationActive:!1}),(0,a.jsx)(z.N,{type:"monotone",dataKey:"x",stroke:"#8b5cf6",strokeWidth:1,dot:!1,name:"X-axis",isAnimationActive:!1}),(0,a.jsx)(z.N,{type:"monotone",dataKey:"y",stroke:"#ec4899",strokeWidth:1,dot:!1,name:"Y-axis",isAnimationActive:!1}),(0,a.jsx)(z.N,{type:"monotone",dataKey:"z",stroke:"#10b981",strokeWidth:1,dot:!1,name:"Z-axis",isAnimationActive:!1})]})})})]},o.sensor_id);var M})}),Z&&(0,a.jsx)("div",{className:"modal-overlay",onClick:()=>P(null),children:(0,a.jsxs)("div",{className:"modal-content",onClick:n=>n.stopPropagation(),children:[(0,a.jsxs)("div",{className:"modal-header",children:[(0,a.jsx)("h2",{children:"Sensor Configuration"}),(0,a.jsx)("button",{onClick:()=>P(null),className:"btn-icon",children:(0,a.jsx)(c.A,{className:"w-5 h-5"})})]}),(0,a.jsx)("div",{className:"modal-body",children:n.find(n=>n.sensor_id===Z)&&(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault();const s=n.find(n=>n.sensor_id===Z);rn(s),P(null)},children:(()=>{const s=n.find(n=>n.sensor_id===Z);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Equipment Name"}),(0,a.jsx)("input",{type:"text",value:s.equipment_name,onChange:s=>{const a=n.map(n=>n.sensor_id===Z?{...n,equipment_name:s.target.value}:n);e(a)}})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Port"}),(0,a.jsx)("select",{value:s.port,onChange:s=>{const a=n.map(n=>n.sensor_id===Z?{...n,port:s.target.value}:n);e(a)},children:M.map(n=>(0,a.jsx)("option",{value:n,children:n},n))})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Modbus Address (Hex)"}),(0,a.jsx)("input",{type:"text",value:`0x${s.modbus_id.toString(16).toUpperCase()}`,onChange:s=>{const a=parseInt(s.target.value,16);if(!isNaN(a)){const s=n.map(n=>n.sensor_id===Z?{...n,modbus_id:a}:n);e(s)}}})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Baud Rate"}),(0,a.jsxs)("select",{value:s.baud_rate,onChange:s=>{const a=n.map(n=>n.sensor_id===Z?{...n,baud_rate:parseInt(s.target.value)}:n);e(a)},children:[(0,a.jsx)("option",{value:"9600",children:"9600"}),(0,a.jsx)("option",{value:"19200",children:"19200"}),(0,a.jsx)("option",{value:"38400",children:"38400"}),(0,a.jsx)("option",{value:"57600",children:"57600"}),(0,a.jsx)("option",{value:"115200",children:"115200"})]})]}),(0,a.jsxs)("div",{className:"form-group",children:[(0,a.jsx)("label",{children:"Alert Threshold (mm/s)"}),(0,a.jsx)("input",{type:"number",step:"0.1",value:s.alert_threshold_mms,onChange:s=>{const a=n.map(n=>n.sensor_id===Z?{...n,alert_threshold_mms:parseFloat(s.target.value)}:n);e(a)}}),(0,a.jsx)("small",{children:"ISO 10816-3: Zone B=7.1, Zone C=11.0"})]}),(0,a.jsxs)("div",{className:"form-actions",children:[(0,a.jsxs)("button",{type:"submit",className:"btn-primary",children:[(0,a.jsx)(y.A,{className:"w-4 h-4"}),"Save Configuration"]}),(0,a.jsx)("button",{type:"button",onClick:()=>P(null),className:"btn-secondary",children:"Cancel"})]})]})})()})})]})})]})}}}]);