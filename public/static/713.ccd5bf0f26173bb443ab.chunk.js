"use strict";(self.webpackChunkautomata_neural_nexus_portal=self.webpackChunkautomata_neural_nexus_portal||[]).push([[713],{2102:(e,n,r)=>{r.d(n,{$:()=>l});var a=r(4848),t=r(6540),o=r(3362);function s(...e){return e.filter(Boolean).join(" ")}const i=(0,r(2732).F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",teal:"bg-teal-500/10 text-teal-600 hover:bg-teal-500/20 border border-teal-200",sidebar:"w-full justify-start text-left bg-transparent hover:bg-gradient-to-r hover:from-teal-500/10 hover:to-cyan-500/10 transition-all duration-200",sidebarActive:"w-full justify-start text-left bg-gradient-to-r from-teal-500/20 to-cyan-500/20 border-l-3 border-teal-500"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=t.forwardRef(({className:e,variant:n,size:r,asChild:t=!1,...l},d)=>{const c=t?o.DX:"button";return(0,a.jsx)(c,{className:s(i({variant:n,size:r,className:e})),ref:d,...l})});l.displayName="Button"},7713:(e,n,r)=>{r.r(n),r.d(n,{default:()=>j});var a=r(4848),t=r(6540),o=r(923);const s=t.forwardRef(({className:e,...n},r)=>(0,a.jsx)(o.bL,{className:`\n      peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full \n      border-2 border-transparent transition-colors \n      focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-teal-500 focus-visible:ring-offset-2 \n      focus-visible:ring-offset-white \n      disabled:cursor-not-allowed disabled:opacity-50 \n      data-[state=checked]:bg-gradient-to-r data-[state=checked]:from-teal-500 data-[state=checked]:to-cyan-500 \n      data-[state=unchecked]:bg-gray-200\n      ${e||""}\n    `,...n,ref:r,children:(0,a.jsx)(o.zi,{className:"\n        pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 \n        transition-transform \n        data-[state=checked]:translate-x-5 \n        data-[state=unchecked]:translate-x-0\n      "})}));s.displayName=o.bL.displayName;var i=r(2102),l=r(5072),d=r.n(l),c=r(7825),h=r.n(c),m=r(7659),p=r.n(m),u=r(5056),g=r.n(u),f=r(540),b=r.n(f),x=r(1113),w=r.n(x),y=r(9412),v={};v.styleTagTransform=w(),v.setAttributes=g(),v.insert=p().bind(null,"head"),v.domAPI=h(),v.insertStyleElement=b(),d()(y.A,v),y.A&&y.A.locals&&y.A.locals;const j=()=>{const[e,n]=(0,t.useState)([]),[r,o]=(0,t.useState)([]),[l,d]=(0,t.useState)(!1),[c,h]=(0,t.useState)(!0);(0,t.useEffect)(()=>{m(),p()},[]);const m=async()=>{try{const e=sessionStorage.getItem("authToken"),n=await fetch("/api/logic/boards",{headers:{Authorization:e?`Bearer ${e}`:"","Content-Type":"application/json"}});if(n.ok){const r=await n.json(),a=[];a.push({key:"setpoint",name:"Temperature Setpoint",unit:"°F",type:"temperature"}),r.forEach(e=>{e.enabled&&e.inputs&&Object.entries(e.inputs).forEach(([,e])=>{if(e&&e.enabled&&e.name){const n=e.name.toLowerCase().replace(/[^a-z0-9]+/g,"_").replace(/^_|_$/g,"");let r="",t="other";"temperature"===e.conversionType||e.name.toLowerCase().includes("temp")?(r="°F",t="temperature"):"amps"===e.conversionType||e.name.toLowerCase().includes("current")||e.name.toLowerCase().includes("vfd")||e.name.toLowerCase().includes("pump")?(r="A",t="current"):"0-10V"===e.inputType&&(r="V",t="voltage"),a.find(e=>e.key===n)||a.push({key:n,name:e.name,unit:r,type:t})}})}),a.find(e=>"outdoor_air_temp"===e.key)||a.push({key:"outdoor_air_temp",name:"Outdoor Air Temp",unit:"°F",type:"temperature"});const t=await fetch("/api/vibration/sensors",{headers:{Authorization:e?`Bearer ${e}`:"","Content-Type":"application/json"}});t.ok&&(await t.json()).forEach(e=>{const n=`vib_${e.sensor_id}`;a.find(e=>e.key===n)||a.push({key:n,name:`Vibration - ${e.equipment_name}`,unit:"mm/s",type:"other"})}),o(a)}}catch(e){console.error("Failed to fetch board configs:",e),o([{key:"setpoint",name:"Temperature Setpoint",unit:"°F",type:"temperature"},{key:"tower_loop_supply_temp",name:"Tower Loop Supply Temp",unit:"°F",type:"temperature"},{key:"tower_loop_return_temp",name:"Tower Loop Return Temp",unit:"°F",type:"temperature"}])}},p=async()=>{try{const e=sessionStorage.getItem("authToken"),r=await fetch("/api/alarms/thresholds",{headers:{Authorization:e?`Bearer ${e}`:"","Content-Type":"application/json"}});if(r.ok){const e=await r.json();n(e)}else n([{id:"1",name:"High Tower Supply Temp",parameter:"tower_loop_supply_temp",minValue:-999,maxValue:105,unit:"°F",enabled:!0,alarmType:"warning"},{id:"2",name:"Low Tower Return Temp",parameter:"tower_loop_return_temp",minValue:85,maxValue:999,unit:"°F",enabled:!0,alarmType:"warning"}])}catch(e){console.error("Failed to fetch thresholds:",e)}finally{h(!1)}},u=(e,a,t)=>{n(n=>n.map(n=>{if(n.id===e){const e={...n,[a]:t};if("parameter"===a){const n=r.find(e=>e.key===t);n&&(e.unit=n.unit)}return e}return n}))};return c?(0,a.jsxs)("div",{className:"thresholds-page",children:[(0,a.jsx)("div",{className:"page-header",children:(0,a.jsxs)("h1",{children:[(0,a.jsx)("i",{className:"fas fa-thermometer-half"})," NexusController Alarm Thresholds"]})}),(0,a.jsx)("div",{className:"loading-message",children:"Loading sensor configurations..."})]}):(0,a.jsxs)("div",{className:"thresholds-page",children:[(0,a.jsxs)("div",{className:"page-header",children:[(0,a.jsxs)("h1",{children:[(0,a.jsx)("i",{className:"fas fa-thermometer-half"})," NexusController Alarm Thresholds"]}),(0,a.jsxs)(i.$,{onClick:async()=>{d(!0);try{const n=sessionStorage.getItem("authToken");console.log("Saving thresholds:",e);const r=await fetch("/api/alarms/thresholds",{method:"POST",headers:{Authorization:n?`Bearer ${n}`:"","Content-Type":"application/json"},body:JSON.stringify(e)});if(r.ok){const e=await r.json();console.log("Save successful:",e),alert("Thresholds saved successfully"),await p()}else{const e=await r.text();console.error("Save failed:",r.status,e),alert(`Failed to save thresholds: ${e}`)}}catch(e){console.error("Save error:",e),alert(`Failed to save thresholds: ${e}`)}d(!1)},disabled:l,variant:"teal",style:{background:"linear-gradient(135deg, #14b8a6 0%, #0d9488 100%)",color:"white",border:"none",padding:"10px 20px"},children:[(0,a.jsx)("i",{className:"fas fa-save",style:{marginRight:"8px"}}),l?"Saving...":"Save Changes"]})]}),(0,a.jsxs)("div",{className:"sensor-info",children:[(0,a.jsx)("i",{className:"fas fa-info-circle"}),(0,a.jsxs)("span",{children:["Configured Sensors: ",r.length]})]}),(0,a.jsxs)("div",{className:"thresholds-grid",children:[e.map(t=>(0,a.jsxs)("div",{className:`threshold-card ${t.alarmType}`,children:[(0,a.jsxs)("div",{className:"card-header",children:[(0,a.jsx)("input",{type:"text",value:t.name,onChange:e=>u(t.id,"name",e.target.value),className:"threshold-name-input",placeholder:"Enter threshold name (e.g., High Pump Current, Low Supply Temp)"}),(0,a.jsx)("button",{onClick:()=>{return r=t.id,void(confirm("Are you sure you want to delete this threshold?")&&n(e.filter(e=>e.id!==r)));var r},className:"btn-delete",title:"Delete Threshold",children:(0,a.jsx)("i",{className:"fas fa-trash"})})]}),(0,a.jsxs)("div",{className:"card-body",children:[(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsx)("label",{children:"Sensor Parameter"}),(0,a.jsx)("select",{value:t.parameter,onChange:e=>u(t.id,"parameter",e.target.value),children:r.map(e=>(0,a.jsxs)("option",{value:e.key,children:[e.name," ",e.unit&&`(${e.unit})`]},e.key))})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsx)("label",{children:"Alarm Type"}),(0,a.jsxs)("select",{value:t.alarmType,onChange:e=>u(t.id,"alarmType",e.target.value),children:[(0,a.jsx)("option",{value:"warning",children:"Warning"}),(0,a.jsx)("option",{value:"critical",children:"Critical"})]})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsx)("label",{children:"Min Value"}),(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("input",{type:"number",value:t.minValue,onChange:e=>u(t.id,"minValue",parseFloat(e.target.value)),placeholder:"Use -999 for no minimum"}),(0,a.jsx)("span",{className:"unit",children:t.unit})]})]}),(0,a.jsxs)("div",{className:"form-row",children:[(0,a.jsx)("label",{children:"Max Value"}),(0,a.jsxs)("div",{className:"input-group",children:[(0,a.jsx)("input",{type:"number",value:t.maxValue,onChange:e=>u(t.id,"maxValue",parseFloat(e.target.value)),placeholder:"Use 999 for no maximum"}),(0,a.jsx)("span",{className:"unit",children:t.unit})]})]}),(0,a.jsxs)("div",{className:"toggle-row",children:[(0,a.jsxs)("label",{htmlFor:`switch-${t.id}`,className:"toggle-label",children:[(0,a.jsx)("i",{className:"fas fa-"+(t.enabled?"check-circle":"times-circle")}),(0,a.jsx)("span",{children:t.enabled?"Monitoring Enabled":"Monitoring Disabled"})]}),(0,a.jsx)(s,{id:`switch-${t.id}`,checked:t.enabled,onCheckedChange:e=>u(t.id,"enabled",e)})]})]})]},t.id)),(0,a.jsxs)("div",{className:"threshold-card add-card",onClick:()=>{const r={id:`t-${Date.now()}`,name:"",parameter:"",minValue:0,maxValue:100,unit:"",enabled:!0,alarmType:"warning"};n([...e,r])},children:[(0,a.jsx)("i",{className:"fas fa-plus-circle"}),(0,a.jsx)("span",{children:"Add New Threshold"})]})]}),(0,a.jsxs)("div",{className:"threshold-legend",children:[(0,a.jsx)("h3",{children:"Threshold Guidelines"}),(0,a.jsxs)("ul",{children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Min Value:"})," Set to -999 to disable minimum threshold checking"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Max Value:"})," Set to 999 to disable maximum threshold checking"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Warning:"})," Non-critical alerts that notify but don't require immediate action"]}),(0,a.jsxs)("li",{children:[(0,a.jsx)("strong",{children:"Critical:"})," Urgent alerts requiring immediate attention"]})]})]})]})}},9412:(e,n,r)=>{r.d(n,{A:()=>i});var a=r(1601),t=r.n(a),o=r(6314),s=r.n(o)()(t());s.push([e.id,"/* Thresholds Page - Light Theme Matching App Aesthetics */\n.thresholds-page {\n  padding: 2rem;\n  background: #f9fafb;\n  min-height: calc(100vh - 3.5rem);\n}\n\n/* Page Header */\n.page-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 2rem;\n  padding: 1.5rem;\n  background: white;\n  border-radius: 0.75rem;\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);\n  border: 1px solid #e5e7eb;\n}\n\n.page-header h1 {\n  color: #111827;\n  font-size: 1.875rem;\n  margin: 0;\n  font-weight: 700;\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n}\n\n.page-header h1 i {\n  color: #14b8a6;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);\n  color: white;\n  border: none;\n  padding: 0.75rem 1.5rem;\n  border-radius: 0.5rem;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n  box-shadow: 0 4px 6px -1px rgba(20, 184, 166, 0.3);\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.btn-primary:hover {\n  transform: translateY(-1px);\n  box-shadow: 0 10px 15px -3px rgba(20, 184, 166, 0.4);\n}\n\n.btn-primary:disabled {\n  background: #9ca3af;\n  cursor: not-allowed;\n  transform: none;\n  box-shadow: none;\n}\n\n/* Grid Layout */\n.thresholds-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));\n  gap: 1.5rem;\n}\n\n/* Threshold Cards */\n.threshold-card {\n  background: white;\n  border-radius: 0.75rem;\n  overflow: hidden;\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);\n  transition: all 0.2s;\n  border: 1px solid #e5e7eb;\n}\n\n.threshold-card:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);\n}\n\n.threshold-card.warning {\n  border-top: 3px solid #f59e0b;\n}\n\n.threshold-card.critical {\n  border-top: 3px solid #ef4444;\n}\n\n/* Card Header */\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.25rem;\n  background: #f9fafb;\n  border-bottom: 1px solid #e5e7eb;\n}\n\n.threshold-name-input {\n  background: transparent;\n  border: 2px solid transparent;\n  font-size: 1.125rem;\n  font-weight: 600;\n  color: #111827;\n  flex: 1;\n  padding: 0.375rem 0.5rem;\n  border-radius: 0.375rem;\n  transition: all 0.2s;\n}\n\n.threshold-name-input:hover {\n  background: white;\n  border-color: #e5e7eb;\n}\n\n.threshold-name-input:focus {\n  background: white;\n  border-color: #14b8a6;\n  outline: none;\n  box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);\n}\n\n.btn-delete {\n  background: #fef2f2;\n  color: #ef4444;\n  border: 1px solid #fecaca;\n  padding: 0.5rem 0.75rem;\n  border-radius: 0.375rem;\n  cursor: pointer;\n  transition: all 0.2s;\n  display: flex;\n  align-items: center;\n  gap: 0.375rem;\n  font-size: 0.875rem;\n}\n\n.btn-delete:hover {\n  background: #ef4444;\n  border-color: #ef4444;\n  color: white;\n  transform: scale(1.05);\n}\n\n/* Card Body */\n.card-body {\n  padding: 1.25rem;\n  display: flex;\n  flex-direction: column;\n  gap: 0.75rem;\n}\n\n/* Form Rows */\n.form-row {\n  display: flex;\n  align-items: center;\n  padding: 0.75rem;\n  background: #f9fafb;\n  border-radius: 0.5rem;\n  transition: background 0.2s;\n}\n\n.form-row:hover {\n  background: #f3f4f6;\n}\n\n.form-row label {\n  flex: 0 0 120px;\n  color: #6b7280;\n  font-weight: 500;\n  font-size: 0.875rem;\n}\n\n.form-row select,\n.form-row input[type=\"number\"] {\n  flex: 1;\n  padding: 0.5rem 0.75rem;\n  background: white;\n  border: 1px solid #d1d5db;\n  border-radius: 0.375rem;\n  font-size: 0.875rem;\n  color: #374151;\n  transition: all 0.2s;\n}\n\n.form-row select:focus,\n.form-row input[type=\"number\"]:focus {\n  outline: none;\n  border-color: #14b8a6;\n  box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);\n}\n\n.form-row select option {\n  background: white;\n  color: #374151;\n}\n\n/* Input Group */\n.input-group {\n  display: flex;\n  align-items: center;\n  flex: 1;\n  gap: 0.5rem;\n}\n\n.input-group input {\n  flex: 1;\n}\n\n.unit {\n  color: #14b8a6;\n  font-weight: 600;\n  font-size: 0.875rem;\n  min-width: 30px;\n}\n\n/* Toggle Row with Radix UI Switch */\n.toggle-row {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0.875rem;\n  background: linear-gradient(135deg, #f0fdf4 0%, #ecfdf5 100%);\n  border-radius: 0.5rem;\n  margin-top: 0.25rem;\n  border: 1px solid #a7f3d0;\n}\n\n.toggle-label {\n  color: #374151;\n  font-weight: 500;\n  font-size: 0.875rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  cursor: pointer;\n}\n\n.toggle-label i.fa-check-circle {\n  color: #10b981;\n}\n\n.toggle-label i.fa-times-circle {\n  color: #ef4444;\n}\n\n/* Radix UI Switch Styles */\n.switch-root {\n  width: 52px;\n  height: 28px;\n  background-color: #d1d5db;\n  border-radius: 9999px;\n  position: relative;\n  transition: background-color 0.2s;\n  cursor: pointer;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.switch-root:hover {\n  background-color: #9ca3af;\n}\n\n.switch-root[data-state='checked'] {\n  background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);\n}\n\n.switch-root[data-state='checked']:hover {\n  background: linear-gradient(135deg, #10b981 0%, #059669 100%);\n}\n\n.switch-root:focus-visible {\n  outline: 2px solid #14b8a6;\n  outline-offset: 2px;\n}\n\n.switch-thumb {\n  display: block;\n  width: 22px;\n  height: 22px;\n  background-color: white;\n  border-radius: 9999px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.14);\n  transition: transform 0.2s;\n  transform: translateX(3px);\n  will-change: transform;\n}\n\n.switch-thumb[data-state='checked'] {\n  transform: translateX(27px);\n}\n\n/* Add New Card */\n.add-card {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  background: white;\n  border: 2px dashed #d1d5db;\n  color: #9ca3af;\n  transition: all 0.2s;\n  min-height: 280px;\n  border-radius: 0.75rem;\n}\n\n.add-card:hover {\n  background: #f0fdf4;\n  border-color: #14b8a6;\n  color: #14b8a6;\n  transform: translateY(-2px);\n  box-shadow: 0 10px 15px -3px rgba(20, 184, 166, 0.2);\n}\n\n.add-card i {\n  font-size: 3rem;\n  margin-bottom: 0.75rem;\n  transition: transform 0.3s;\n}\n\n.add-card:hover i {\n  transform: scale(1.1) rotate(90deg);\n}\n\n.add-card span {\n  font-size: 1rem;\n  font-weight: 600;\n  text-transform: uppercase;\n  letter-spacing: 0.05em;\n}\n\n/* Responsive adjustments */\n@media (max-width: 768px) {\n  .thresholds-grid {\n    grid-template-columns: 1fr;\n  }\n  \n  .page-header {\n    flex-direction: column;\n    gap: 1rem;\n    align-items: stretch;\n  }\n  \n  .btn-primary {\n    justify-content: center;\n  }\n}",""]);const i=s}}]);